{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///home/pjw75/tailwind/src/app/api/auth/openid/route.js"],"sourcesContent":["import { NextResponse } from \"next/server\"\n\nconst SESSION_COOKIE = \"app_session_user\"\nconst MAX_AGE_SECONDS = 60 * 60 * 24 * 7 // 7 days\n\nconst DUMMY_USER = Object.freeze({\n  id: \"demo-operator-01\",\n  name: \"Demo Operator\",\n  email: \"operator@example.com\",\n  avatar: \"/avatars/shadcn.jpg\",\n  locale: \"ko-KR\",\n  roles: [\"operator\"],\n})\n\nfunction encodeSession(payload) {\n  try {\n    return Buffer.from(JSON.stringify(payload), \"utf8\").toString(\"base64url\")\n  } catch {\n    return \"\"\n  }\n}\n\nfunction decodeSession(rawValue) {\n  if (!rawValue) return null\n  try {\n    const decoded = Buffer.from(rawValue, \"base64url\").toString(\"utf8\")\n    return JSON.parse(decoded)\n  } catch {\n    return null\n  }\n}\n\nexport async function POST() {\n  const session = {\n    user: DUMMY_USER,\n    issuedAt: Date.now(),\n  }\n\n  const response = NextResponse.json({ success: true, user: DUMMY_USER })\n\n  response.cookies.set({\n    name: SESSION_COOKIE,\n    value: encodeSession(session),\n    httpOnly: true,\n    sameSite: \"lax\",\n    secure: process.env.NODE_ENV === \"production\",\n    path: \"/\",\n    maxAge: MAX_AGE_SECONDS,\n  })\n\n  return response\n}\n\nexport async function GET(request) {\n  const cookie = request.cookies.get(SESSION_COOKIE)\n  const session = decodeSession(cookie?.value)\n\n  if (!session || !session.user) {\n    const response = NextResponse.json(\n      { success: false, user: null, error: \"NOT_AUTHENTICATED\" },\n      { status: 401 }\n    )\n\n    if (cookie) {\n      response.cookies.set({\n        name: SESSION_COOKIE,\n        value: \"\",\n        path: \"/\",\n        maxAge: 0,\n      })\n    }\n\n    return response\n  }\n\n  return NextResponse.json({ success: true, user: session.user })\n}\n\nexport async function DELETE() {\n  const response = NextResponse.json({ success: true })\n  response.cookies.set({\n    name: SESSION_COOKIE,\n    value: \"\",\n    path: \"/\",\n    maxAge: 0,\n  })\n  return response\n}\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAEA,MAAM,iBAAiB;AACvB,MAAM,kBAAkB,KAAK,KAAK,KAAK,EAAE,SAAS;;AAElD,MAAM,aAAa,OAAO,MAAM,CAAC;IAC/B,IAAI;IACJ,MAAM;IACN,OAAO;IACP,QAAQ;IACR,QAAQ;IACR,OAAO;QAAC;KAAW;AACrB;AAEA,SAAS,cAAc,OAAO;IAC5B,IAAI;QACF,OAAO,OAAO,IAAI,CAAC,KAAK,SAAS,CAAC,UAAU,QAAQ,QAAQ,CAAC;IAC/D,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEA,SAAS,cAAc,QAAQ;IAC7B,IAAI,CAAC,UAAU,OAAO;IACtB,IAAI;QACF,MAAM,UAAU,OAAO,IAAI,CAAC,UAAU,aAAa,QAAQ,CAAC;QAC5D,OAAO,KAAK,KAAK,CAAC;IACpB,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,eAAe;IACpB,MAAM,UAAU;QACd,MAAM;QACN,UAAU,KAAK,GAAG;IACpB;IAEA,MAAM,WAAW,iXAAY,CAAC,IAAI,CAAC;QAAE,SAAS;QAAM,MAAM;IAAW;IAErE,SAAS,OAAO,CAAC,GAAG,CAAC;QACnB,MAAM;QACN,OAAO,cAAc;QACrB,UAAU;QACV,UAAU;QACV,QAAQ,oDAAyB;QACjC,MAAM;QACN,QAAQ;IACV;IAEA,OAAO;AACT;AAEO,eAAe,IAAI,OAAO;IAC/B,MAAM,SAAS,QAAQ,OAAO,CAAC,GAAG,CAAC;IACnC,MAAM,UAAU,cAAc,QAAQ;IAEtC,IAAI,CAAC,WAAW,CAAC,QAAQ,IAAI,EAAE;QAC7B,MAAM,WAAW,iXAAY,CAAC,IAAI,CAChC;YAAE,SAAS;YAAO,MAAM;YAAM,OAAO;QAAoB,GACzD;YAAE,QAAQ;QAAI;QAGhB,IAAI,QAAQ;YACV,SAAS,OAAO,CAAC,GAAG,CAAC;gBACnB,MAAM;gBACN,OAAO;gBACP,MAAM;gBACN,QAAQ;YACV;QACF;QAEA,OAAO;IACT;IAEA,OAAO,iXAAY,CAAC,IAAI,CAAC;QAAE,SAAS;QAAM,MAAM,QAAQ,IAAI;IAAC;AAC/D;AAEO,eAAe;IACpB,MAAM,WAAW,iXAAY,CAAC,IAAI,CAAC;QAAE,SAAS;IAAK;IACnD,SAAS,OAAO,CAAC,GAAG,CAAC;QACnB,MAAM;QACN,OAAO;QACP,MAAM;QACN,QAAQ;IACV;IACA,OAAO;AACT","debugId":null}}]
}