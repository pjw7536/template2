{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///home/pjw75/tailwind/src/lib/db.js"],"sourcesContent":["import mysql from \"mysql2/promise\"\n\nlet pool = null\n\nfunction getConfig() {\n  const host = process.env.DB_HOST ?? \"127.0.0.1\"\n  const port = Number.parseInt(process.env.DB_PORT ?? \"3307\", 10)\n  const user = process.env.DB_USER ?? \"drone_user\"\n  const password = process.env.DB_PASSWORD ?? \"dronepwd\"\n  const database = process.env.DB_NAME ?? \"drone_sop\"\n\n  return {\n    host,\n    port: Number.isNaN(port) ? 3307 : port,\n    user,\n    password,\n    database,\n  }\n}\n\nexport function getPool() {\n  if (!pool) {\n    const config = getConfig()\n    pool = mysql.createPool({\n      ...config,\n      waitForConnections: true,\n      connectionLimit: 10,\n      timezone: \"Z\",\n    })\n  }\n\n  return pool\n}\n\nexport async function runQuery(sql, params = []) {\n  const currentPool = getPool()\n  const [rows] = await currentPool.query(sql, params)\n  return rows\n}\n"],"names":[],"mappings":";;;;;;;;;;;;AAEA,IAAI,OAAO;AAEX,SAAS;IACP,MAAM,OAAO,QAAQ,GAAG,CAAC,OAAO,IAAI;IACpC,MAAM,OAAO,OAAO,QAAQ,CAAC,QAAQ,GAAG,CAAC,OAAO,IAAI,QAAQ;IAC5D,MAAM,OAAO,QAAQ,GAAG,CAAC,OAAO,IAAI;IACpC,MAAM,WAAW,QAAQ,GAAG,CAAC,WAAW,IAAI;IAC5C,MAAM,WAAW,QAAQ,GAAG,CAAC,OAAO,IAAI;IAExC,OAAO;QACL;QACA,MAAM,OAAO,KAAK,CAAC,QAAQ,OAAO;QAClC;QACA;QACA;IACF;AACF;AAEO,SAAS;IACd,IAAI,CAAC,MAAM;QACT,MAAM,SAAS;QACf,OAAO,MAAM,UAAU,CAAC;YACtB,GAAG,MAAM;YACT,oBAAoB;YACpB,iBAAiB;YACjB,UAAU;QACZ;IACF;IAEA,OAAO;AACT;AAEO,eAAe,SAAS,GAAG,EAAE,SAAS,EAAE;IAC7C,MAAM,cAAc;IACpB,MAAM,CAAC,KAAK,GAAG,MAAM,YAAY,KAAK,CAAC,KAAK;IAC5C,OAAO;AACT","debugId":null}},
    {"offset": {"line": 94, "column": 0}, "map": {"version":3,"sources":["file:///home/pjw75/tailwind/src/features/line-dashboard/api/get-line-dashboard.js"],"sourcesContent":["import { runQuery } from \"@/lib/db\"\n\nconst DEFAULT_TABLE_NAME = \"drone_sop_v3\"\nconst TREND_LOOKBACK_DAYS = 90\nconst RECENT_LIMIT = 10\n\nconst toISODate = (input) => {\n  if (!input) return null\n  const date = input instanceof Date ? input : new Date(input)\n  return Number.isNaN(date.getTime()) ? null : date.toISOString()\n}\n\nconst mapSummaryRow = (row) => ({\n  totalCount: Number(row.totalCount ?? 0),\n  activeCount: Number(row.activeCount ?? 0),\n  completedCount: Number(row.completedCount ?? 0),\n  pendingJiraCount: Number(row.pendingJiraCount ?? 0),\n  lotCount: Number(row.lotCount ?? 0),\n  latestUpdatedAt: toISODate(row.latestUpdatedAt),\n})\n\nconst mapTrendRows = (rows) =>\n  rows.map((row) => ({\n    date: toISODate(row.day)?.slice(0, 10) ?? \"\",\n    activeCount: Number(row.activeCount ?? 0),\n    completedCount: Number(row.completedCount ?? 0),\n  }))\n\nconst mapRecentRows = (rows) =>\n  rows.map((row) => ({\n    id: row.id,\n    lotId: row.lot_id ?? null,\n    status: row.status ?? null,\n    createdAt: toISODate(row.created_at) ?? \"\",\n  }))\n\nexport async function getLineDashboard(lineId) {\n  const [summaryRow] = await runQuery(\n    `\n      SELECT\n        COUNT(*) AS totalCount,\n        SUM(CASE WHEN status = 'Completed' THEN 1 ELSE 0 END) AS completedCount,\n        SUM(CASE WHEN status <> 'Completed' THEN 1 ELSE 0 END) AS activeCount,\n        SUM(CASE WHEN send_jira = 0 AND needtosend = 1 THEN 1 ELSE 0 END) AS pendingJiraCount,\n        COUNT(DISTINCT lot_id) AS lotCount,\n        MAX(updated_at) AS latestUpdatedAt\n      FROM ${DEFAULT_TABLE_NAME}\n      WHERE line_id = ?\n    `,\n    [lineId]\n  )\n\n  if (!summaryRow || Number(summaryRow.totalCount ?? 0) === 0) {\n    return null\n  }\n\n  const trendRows = await runQuery(\n    `\n      SELECT\n        DATE(created_at) AS day,\n        SUM(CASE WHEN status = 'Completed' THEN 1 ELSE 0 END) AS completedCount,\n        SUM(CASE WHEN status <> 'Completed' THEN 1 ELSE 0 END) AS activeCount\n      FROM ${DEFAULT_TABLE_NAME}\n      WHERE line_id = ? AND created_at IS NOT NULL\n        AND created_at >= DATE_SUB(CURDATE(), INTERVAL ? DAY)\n      GROUP BY DATE(created_at)\n      ORDER BY day ASC\n    `,\n    [lineId, TREND_LOOKBACK_DAYS]\n  )\n\n  const recentRows = await runQuery(\n    `\n      SELECT\n        id,\n        lot_id,\n        status,\n        created_at\n      FROM ${DEFAULT_TABLE_NAME}\n      WHERE line_id = ?\n      ORDER BY created_at DESC\n      LIMIT ?\n    `,\n    [lineId, RECENT_LIMIT]\n  )\n\n  return {\n    lineId,\n    summary: mapSummaryRow(summaryRow),\n    trend: mapTrendRows(trendRows),\n    recent: mapRecentRows(recentRows),\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,qBAAqB;AAC3B,MAAM,sBAAsB;AAC5B,MAAM,eAAe;AAErB,MAAM,YAAY,CAAC;IACjB,IAAI,CAAC,OAAO,OAAO;IACnB,MAAM,OAAO,iBAAiB,OAAO,QAAQ,IAAI,KAAK;IACtD,OAAO,OAAO,KAAK,CAAC,KAAK,OAAO,MAAM,OAAO,KAAK,WAAW;AAC/D;AAEA,MAAM,gBAAgB,CAAC,MAAQ,CAAC;QAC9B,YAAY,OAAO,IAAI,UAAU,IAAI;QACrC,aAAa,OAAO,IAAI,WAAW,IAAI;QACvC,gBAAgB,OAAO,IAAI,cAAc,IAAI;QAC7C,kBAAkB,OAAO,IAAI,gBAAgB,IAAI;QACjD,UAAU,OAAO,IAAI,QAAQ,IAAI;QACjC,iBAAiB,UAAU,IAAI,eAAe;IAChD,CAAC;AAED,MAAM,eAAe,CAAC,OACpB,KAAK,GAAG,CAAC,CAAC,MAAQ,CAAC;YACjB,MAAM,UAAU,IAAI,GAAG,GAAG,MAAM,GAAG,OAAO;YAC1C,aAAa,OAAO,IAAI,WAAW,IAAI;YACvC,gBAAgB,OAAO,IAAI,cAAc,IAAI;QAC/C,CAAC;AAEH,MAAM,gBAAgB,CAAC,OACrB,KAAK,GAAG,CAAC,CAAC,MAAQ,CAAC;YACjB,IAAI,IAAI,EAAE;YACV,OAAO,IAAI,MAAM,IAAI;YACrB,QAAQ,IAAI,MAAM,IAAI;YACtB,WAAW,UAAU,IAAI,UAAU,KAAK;QAC1C,CAAC;AAEI,eAAe,iBAAiB,MAAM;IAC3C,MAAM,CAAC,WAAW,GAAG,MAAM,IAAA,0IAAQ,EACjC,CAAC;;;;;;;;WAQM,EAAE,mBAAmB;;IAE5B,CAAC,EACD;QAAC;KAAO;IAGV,IAAI,CAAC,cAAc,OAAO,WAAW,UAAU,IAAI,OAAO,GAAG;QAC3D,OAAO;IACT;IAEA,MAAM,YAAY,MAAM,IAAA,0IAAQ,EAC9B,CAAC;;;;;WAKM,EAAE,mBAAmB;;;;;IAK5B,CAAC,EACD;QAAC;QAAQ;KAAoB;IAG/B,MAAM,aAAa,MAAM,IAAA,0IAAQ,EAC/B,CAAC;;;;;;WAMM,EAAE,mBAAmB;;;;IAI5B,CAAC,EACD;QAAC;QAAQ;KAAa;IAGxB,OAAO;QACL;QACA,SAAS,cAAc;QACvB,OAAO,aAAa;QACpB,QAAQ,cAAc;IACxB;AACF","debugId":null}},
    {"offset": {"line": 183, "column": 0}, "map": {"version":3,"sources":["file:///home/pjw75/tailwind/src/features/line-dashboard/api/get-line-ids.js"],"sourcesContent":["import { runQuery } from \"@/lib/db\"\n\nconst DEFAULT_TABLE_NAME = \"drone_sop_v3\"\n\nexport async function getDistinctLineIds() {\n  const rows = await runQuery(\n    `\n      SELECT DISTINCT line_id\n      FROM ${DEFAULT_TABLE_NAME}\n      WHERE line_id IS NOT NULL AND line_id <> ''\n      ORDER BY line_id\n    `\n  )\n\n  return rows\n    .map((row) => row.line_id)\n    .filter((lineId) => typeof lineId === \"string\" && lineId.length > 0)\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,qBAAqB;AAEpB,eAAe;IACpB,MAAM,OAAO,MAAM,IAAA,0IAAQ,EACzB,CAAC;;WAEM,EAAE,mBAAmB;;;IAG5B,CAAC;IAGH,OAAO,KACJ,GAAG,CAAC,CAAC,MAAQ,IAAI,OAAO,EACxB,MAAM,CAAC,CAAC,SAAW,OAAO,WAAW,YAAY,OAAO,MAAM,GAAG;AACtE","debugId":null}},
    {"offset": {"line": 203, "column": 0}, "map": {"version":3,"sources":["file:///home/pjw75/tailwind/src/features/line-dashboard/api/index.js"],"sourcesContent":["export { getLineDashboard } from \"./get-line-dashboard\"\nexport { getDistinctLineIds } from \"./get-line-ids\"\n"],"names":[],"mappings":";AAAA;AACA","debugId":null}},
    {"offset": {"line": 212, "column": 0}, "map": {"version":3,"sources":["file:///home/pjw75/tailwind/src/features/line-dashboard/components/data-table/data-table.jsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const DataTable = registerClientReference(\n    function() { throw new Error(\"Attempted to call DataTable() from the server but DataTable is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/tailwind/src/features/line-dashboard/components/data-table/data-table.jsx <module evaluation>\",\n    \"DataTable\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;AACO,MAAM,YAAY,IAAA,sRAAuB,EAC5C;IAAa,MAAM,IAAI,MAAM;AAAkO,GAC/P,2GACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 226, "column": 0}, "map": {"version":3,"sources":["file:///home/pjw75/tailwind/src/features/line-dashboard/components/data-table/data-table.jsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const DataTable = registerClientReference(\n    function() { throw new Error(\"Attempted to call DataTable() from the server but DataTable is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/tailwind/src/features/line-dashboard/components/data-table/data-table.jsx\",\n    \"DataTable\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;AACO,MAAM,YAAY,IAAA,sRAAuB,EAC5C;IAAa,MAAM,IAAI,MAAM;AAAkO,GAC/P,uFACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 240, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 248, "column": 0}, "map": {"version":3,"sources":["file:///home/pjw75/tailwind/src/features/line-dashboard/components/data-table/index.js"],"sourcesContent":["export { DataTable } from \"./data-table\"\n"],"names":[],"mappings":";AAAA","debugId":null}},
    {"offset": {"line": 255, "column": 0}, "map": {"version":3,"sources":["file:///home/pjw75/tailwind/src/features/line-dashboard/components/index.js"],"sourcesContent":["export { DataTable } from \"./data-table\"\n\n"],"names":[],"mappings":";AAAA","debugId":null}},
    {"offset": {"line": 262, "column": 0}, "map": {"version":3,"sources":["file:///home/pjw75/tailwind/src/features/line-dashboard/index.js"],"sourcesContent":["export * from \"./api\"\nexport * from \"./components\"\n"],"names":[],"mappings":";AAAA;AACA","debugId":null}},
    {"offset": {"line": 284, "column": 0}, "map": {"version":3,"sources":["file:///home/pjw75/tailwind/src/app/api/lines/route.js"],"sourcesContent":["import { NextResponse } from \"next/server\"\n\nimport { getDistinctLineIds } from \"@/features/line-dashboard\"\n\nexport const dynamic = \"force-dynamic\"\n\nexport async function GET() {\n  try {\n    const lineIds = await getDistinctLineIds()\n    return NextResponse.json({ lineIds })\n  } catch (error) {\n    console.error(\"Failed to fetch line IDs\", error)\n    return NextResponse.json({ error: \"Failed to load line identifiers\" }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AAEA;AAAA;;;AAEO,MAAM,UAAU;AAEhB,eAAe;IACpB,IAAI;QACF,MAAM,UAAU,MAAM,IAAA,wLAAkB;QACxC,OAAO,4JAAY,CAAC,IAAI,CAAC;YAAE;QAAQ;IACrC,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,OAAO,4JAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAkC,GAAG;YAAE,QAAQ;QAAI;IACvF;AACF","debugId":null}}]
}