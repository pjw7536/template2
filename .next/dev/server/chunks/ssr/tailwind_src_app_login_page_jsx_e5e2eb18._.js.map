{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/pjw75/tailwind/src/app/login/page.jsx"],"sourcesContent":["\"use client\";\n\n// src/app/login/page.jsx\nimport { useEffect, useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\n\nimport { Button } from \"@/components/ui/button\";\nimport {\n  DUMMY_OPENID_PROVIDER,\n  OPENID_SESSION_KEY,\n} from \"@/features/auth/openid/constants\";\nimport {\n  authenticateWithDummyProvider,\n  clearStoredSession,\n  loadStoredSession,\n} from \"@/features/auth/openid/openIdClient\";\n\nexport default function LoginPage() {\n  const router = useRouter();\n  const [session, setSession] = useState(() => loadStoredSession());\n  const [status, setStatus] = useState(\"idle\");\n  const [message, setMessage] = useState(\"\");\n\n  useEffect(() => {\n    if (typeof window === \"undefined\") {\n      return undefined;\n    }\n\n    const handleStorage = (event) => {\n      if (event.storageArea && event.storageArea !== sessionStorage) {\n        return;\n      }\n\n      if (event.key && event.key !== OPENID_SESSION_KEY) {\n        return;\n      }\n\n      setSession(loadStoredSession());\n    };\n\n    window.addEventListener(\"storage\", handleStorage);\n    return () => window.removeEventListener(\"storage\", handleStorage);\n  }, []);\n\n  const handleLogin = async () => {\n    setStatus(\"loading\");\n    setMessage(\"\");\n\n    try {\n      const payload = await authenticateWithDummyProvider({\n        providerId: DUMMY_OPENID_PROVIDER.id,\n        returnUrl: \"/\",\n      });\n\n      setSession(payload);\n      setStatus(\"success\");\n      setMessage(payload.message ?? \"로그인에 성공했습니다.\");\n\n      setTimeout(() => {\n        router.push(payload.redirectUrl ?? \"/\");\n      }, 600);\n    } catch (error) {\n      setStatus(\"error\");\n      setMessage(error.message ?? \"로그인 중 오류가 발생했습니다.\");\n    }\n  };\n\n  const handleLogout = () => {\n    clearStoredSession();\n    setSession(null);\n    setStatus(\"idle\");\n    setMessage(\"세션이 초기화되었습니다.\");\n  };\n\n  return (\n    <div className=\"flex min-h-[600px] flex-col items-center justify-center gap-10 py-12\">\n      <div className=\"w-full max-w-lg rounded-xl border bg-background p-10 shadow-sm\">\n        <div className=\"space-y-2 text-center\">\n          <h1 className=\"text-3xl font-semibold\">OpenID SSO 로그인</h1>\n          <p className=\"text-muted-foreground\">\n            {DUMMY_OPENID_PROVIDER.description}\n          </p>\n        </div>\n\n        <div className=\"mt-8 space-y-6\">\n          <div className=\"rounded-lg border border-dashed bg-muted/30 p-6 text-left\">\n            <h2 className=\"text-lg font-medium text-foreground\">\n              {DUMMY_OPENID_PROVIDER.name}\n            </h2>\n            <p className=\"mt-2 text-sm text-muted-foreground\">\n              실제 IdP 연동 시 OpenID Authorization Code Flow를 대체할 수 있도록\n              구성된 더미 로그인 절차입니다.\n            </p>\n            <Button\n              className=\"mt-6 w-full\"\n              size=\"lg\"\n              disabled={status === \"loading\"}\n              onClick={handleLogin}\n            >\n              {status === \"loading\" ? \"로그인 처리 중...\" : \"SSO로 로그인\"}\n            </Button>\n          </div>\n\n          {session ? (\n            <div className=\"space-y-2 rounded-lg border bg-accent/30 p-5 text-sm\">\n              <p>\n                <span className=\"font-semibold\">세션 사용자:</span> {session.user?.name}\n              </p>\n              <p>\n                <span className=\"font-semibold\">이메일:</span> {session.user?.email}\n              </p>\n              <p>\n                <span className=\"font-semibold\">토큰 만료:</span> {session.tokens?.expiresAt}\n              </p>\n              <div className=\"flex gap-2 pt-2\">\n                <Button\n                  variant=\"outline\"\n                  className=\"flex-1\"\n                  onClick={() => router.push(session.redirectUrl ?? \"/\")}\n                >\n                  대시보드로 이동\n                </Button>\n                <Button variant=\"ghost\" className=\"flex-1\" onClick={handleLogout}>\n                  세션 초기화\n                </Button>\n              </div>\n            </div>\n          ) : null}\n\n          {message ? (\n            <p\n              className={`text-sm ${\n                status === \"error\"\n                  ? \"text-destructive\"\n                  : \"text-muted-foreground\"\n              }`}\n            >\n              {message}\n            </p>\n          ) : null}\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA,yBAAyB;AACzB;AACA;AAEA;AACA;AAIA;AAXA;;;;;;;AAiBe,SAAS;IACtB,MAAM,SAAS,IAAA,gXAAS;IACxB,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,kbAAQ,EAAC,IAAM,IAAA,kLAAiB;IAC9D,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,kbAAQ,EAAC;IACrC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,kbAAQ,EAAC;IAEvC,IAAA,mbAAS,EAAC;QACR,wCAAmC;YACjC,OAAO;QACT;;;QAEA,MAAM;IAcR,GAAG,EAAE;IAEL,MAAM,cAAc;QAClB,UAAU;QACV,WAAW;QAEX,IAAI;YACF,MAAM,UAAU,MAAM,IAAA,8LAA6B,EAAC;gBAClD,YAAY,mLAAqB,CAAC,EAAE;gBACpC,WAAW;YACb;YAEA,WAAW;YACX,UAAU;YACV,WAAW,QAAQ,OAAO,IAAI;YAE9B,WAAW;gBACT,OAAO,IAAI,CAAC,QAAQ,WAAW,IAAI;YACrC,GAAG;QACL,EAAE,OAAO,OAAO;YACd,UAAU;YACV,WAAW,MAAM,OAAO,IAAI;QAC9B;IACF;IAEA,MAAM,eAAe;QACnB,IAAA,mLAAkB;QAClB,WAAW;QACX,UAAU;QACV,WAAW;IACb;IAEA,qBACE,+cAAC;QAAI,WAAU;kBACb,cAAA,+cAAC;YAAI,WAAU;;8BACb,+cAAC;oBAAI,WAAU;;sCACb,+cAAC;4BAAG,WAAU;sCAAyB;;;;;;sCACvC,+cAAC;4BAAE,WAAU;sCACV,mLAAqB,CAAC,WAAW;;;;;;;;;;;;8BAItC,+cAAC;oBAAI,WAAU;;sCACb,+cAAC;4BAAI,WAAU;;8CACb,+cAAC;oCAAG,WAAU;8CACX,mLAAqB,CAAC,IAAI;;;;;;8CAE7B,+cAAC;oCAAE,WAAU;8CAAqC;;;;;;8CAIlD,+cAAC,wJAAM;oCACL,WAAU;oCACV,MAAK;oCACL,UAAU,WAAW;oCACrB,SAAS;8CAER,WAAW,YAAY,gBAAgB;;;;;;;;;;;;wBAI3C,wBACC,+cAAC;4BAAI,WAAU;;8CACb,+cAAC;;sDACC,+cAAC;4CAAK,WAAU;sDAAgB;;;;;;wCAAc;wCAAE,QAAQ,IAAI,EAAE;;;;;;;8CAEhE,+cAAC;;sDACC,+cAAC;4CAAK,WAAU;sDAAgB;;;;;;wCAAW;wCAAE,QAAQ,IAAI,EAAE;;;;;;;8CAE7D,+cAAC;;sDACC,+cAAC;4CAAK,WAAU;sDAAgB;;;;;;wCAAa;wCAAE,QAAQ,MAAM,EAAE;;;;;;;8CAEjE,+cAAC;oCAAI,WAAU;;sDACb,+cAAC,wJAAM;4CACL,SAAQ;4CACR,WAAU;4CACV,SAAS,IAAM,OAAO,IAAI,CAAC,QAAQ,WAAW,IAAI;sDACnD;;;;;;sDAGD,+cAAC,wJAAM;4CAAC,SAAQ;4CAAQ,WAAU;4CAAS,SAAS;sDAAc;;;;;;;;;;;;;;;;;mCAKpE;wBAEH,wBACC,+cAAC;4BACC,WAAW,CAAC,QAAQ,EAClB,WAAW,UACP,qBACA,yBACJ;sCAED;;;;;mCAED;;;;;;;;;;;;;;;;;;AAKd","debugId":null}}]
}