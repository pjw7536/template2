{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///home/pjw75/tailwind/src/app/api/auth/%5B...nextauth%5D/route.js"],"sourcesContent":["import NextAuth from \"next-auth\"\nimport OAuthProvider from \"next-auth/providers/oauth\"\nimport CredentialsProvider from \"next-auth/providers/credentials\"\n\nconst DUMMY_USER = {\n  id: \"dummy-sso-user\",\n  name: \"SSO Demo User\",\n  email: \"demo.sso@example.com\",\n}\n\nconst oidcIssuer = process.env.AUTH_OIDC_ISSUER\nconst oidcClientId = process.env.AUTH_OIDC_ID\nconst oidcClientSecret = process.env.AUTH_OIDC_SECRET\n\nconst hasOidcConfig =\n  Boolean(oidcIssuer) && Boolean(oidcClientId) && Boolean(oidcClientSecret)\n\nconst providers = [\n  CredentialsProvider({\n    id: \"dummy-sso\",\n    name: \"Dummy SSO\",\n    credentials: {},\n    async authorize() {\n      return DUMMY_USER\n    },\n  }),\n]\n\nif (hasOidcConfig) {\n  const normalizedIssuer = oidcIssuer?.replace(/\\/$/, \"\")\n\n  providers.unshift(\n    OAuthProvider({\n      id: \"oidc\",\n      name: \"OIDC\",\n      issuer: normalizedIssuer,\n      clientId: oidcClientId,\n      clientSecret: oidcClientSecret,\n      wellKnown: `${normalizedIssuer}/.well-known/openid-configuration`,\n      authorization: {\n        params: { scope: \"openid profile email\" },\n      },\n      checks: [\"pkce\", \"state\"],\n      profile(profile) {\n        return {\n          id: profile.sub || profile.id,\n          name: profile.name || profile.preferred_username,\n          email: profile.email || profile.upn || profile.preferred_username,\n          image: profile.picture,\n        }\n      },\n    }),\n  )\n}\n\nexport const authOptions = {\n  providers,\n  pages: {\n    signIn: \"/login\",\n  },\n  session: {\n    strategy: \"jwt\",\n  },\n  callbacks: {\n    async jwt({ token, account, user, profile }) {\n      const currentUser = token.user ?? {}\n\n      if (account?.provider === \"dummy-sso\" && user) {\n        token.user = {\n          ...currentUser,\n          id: user.id,\n          name: user.name,\n          email: user.email,\n        }\n      }\n\n      if (account && profile) {\n        token.user = {\n          ...currentUser,\n          id: profile.sub || profile.id || user?.id || token.sub || currentUser.id,\n          name:\n            profile.name ||\n            profile.preferred_username ||\n            user?.name ||\n            currentUser.name ||\n            token.name,\n          email:\n            profile.email ||\n            profile.upn ||\n            profile.preferred_username ||\n            user?.email ||\n            currentUser.email ||\n            token.email,\n        }\n      }\n\n      if (!token.user && (user || token.sub)) {\n        token.user = {\n          id: user?.id || token.sub || currentUser.id,\n          name: user?.name || token.name || currentUser.name,\n          email: user?.email || token.email || currentUser.email,\n        }\n      }\n\n      token.sub = token.user?.id || token.sub\n      return token\n    },\n    async session({ session, token }) {\n      if (token?.user) {\n        session.user = token.user\n      }\n      return session\n    },\n  },\n}\n\nconst handler = NextAuth(authOptions)\n\nexport { handler as GET, handler as POST }\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;AACA;;;;AAEA,MAAM,aAAa;IACjB,IAAI;IACJ,MAAM;IACN,OAAO;AACT;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,gBAAgB;AAC/C,MAAM,eAAe,QAAQ,GAAG,CAAC,YAAY;AAC7C,MAAM,mBAAmB,QAAQ,GAAG,CAAC,gBAAgB;AAErD,MAAM,gBACJ,QAAQ,eAAe,QAAQ,iBAAiB,QAAQ;AAE1D,MAAM,YAAY;IAChB,IAAA,6XAAmB,EAAC;QAClB,IAAI;QACJ,MAAM;QACN,aAAa,CAAC;QACd,MAAM;YACJ,OAAO;QACT;IACF;CACD;AAED,IAAI,eAAe;IACjB,MAAM,mBAAmB,YAAY,QAAQ,OAAO;IAEpD,UAAU,OAAO,CACf,IAAA,uXAAa,EAAC;QACZ,IAAI;QACJ,MAAM;QACN,QAAQ;QACR,UAAU;QACV,cAAc;QACd,WAAW,GAAG,iBAAiB,iCAAiC,CAAC;QACjE,eAAe;YACb,QAAQ;gBAAE,OAAO;YAAuB;QAC1C;QACA,QAAQ;YAAC;YAAQ;SAAQ;QACzB,SAAQ,OAAO;YACb,OAAO;gBACL,IAAI,QAAQ,GAAG,IAAI,QAAQ,EAAE;gBAC7B,MAAM,QAAQ,IAAI,IAAI,QAAQ,kBAAkB;gBAChD,OAAO,QAAQ,KAAK,IAAI,QAAQ,GAAG,IAAI,QAAQ,kBAAkB;gBACjE,OAAO,QAAQ,OAAO;YACxB;QACF;IACF;AAEJ;AAEO,MAAM,cAAc;IACzB;IACA,OAAO;QACL,QAAQ;IACV;IACA,SAAS;QACP,UAAU;IACZ;IACA,WAAW;QACT,MAAM,KAAI,EAAE,KAAK,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE;YACzC,MAAM,cAAc,MAAM,IAAI,IAAI,CAAC;YAEnC,IAAI,SAAS,aAAa,eAAe,MAAM;gBAC7C,MAAM,IAAI,GAAG;oBACX,GAAG,WAAW;oBACd,IAAI,KAAK,EAAE;oBACX,MAAM,KAAK,IAAI;oBACf,OAAO,KAAK,KAAK;gBACnB;YACF;YAEA,IAAI,WAAW,SAAS;gBACtB,MAAM,IAAI,GAAG;oBACX,GAAG,WAAW;oBACd,IAAI,QAAQ,GAAG,IAAI,QAAQ,EAAE,IAAI,MAAM,MAAM,MAAM,GAAG,IAAI,YAAY,EAAE;oBACxE,MACE,QAAQ,IAAI,IACZ,QAAQ,kBAAkB,IAC1B,MAAM,QACN,YAAY,IAAI,IAChB,MAAM,IAAI;oBACZ,OACE,QAAQ,KAAK,IACb,QAAQ,GAAG,IACX,QAAQ,kBAAkB,IAC1B,MAAM,SACN,YAAY,KAAK,IACjB,MAAM,KAAK;gBACf;YACF;YAEA,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,QAAQ,MAAM,GAAG,GAAG;gBACtC,MAAM,IAAI,GAAG;oBACX,IAAI,MAAM,MAAM,MAAM,GAAG,IAAI,YAAY,EAAE;oBAC3C,MAAM,MAAM,QAAQ,MAAM,IAAI,IAAI,YAAY,IAAI;oBAClD,OAAO,MAAM,SAAS,MAAM,KAAK,IAAI,YAAY,KAAK;gBACxD;YACF;YAEA,MAAM,GAAG,GAAG,MAAM,IAAI,EAAE,MAAM,MAAM,GAAG;YACvC,OAAO;QACT;QACA,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC9B,IAAI,OAAO,MAAM;gBACf,QAAQ,IAAI,GAAG,MAAM,IAAI;YAC3B;YACA,OAAO;QACT;IACF;AACF;AAEA,MAAM,UAAU,IAAA,0WAAQ,EAAC","debugId":null}}]
}