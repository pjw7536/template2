{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///home/pjw75/tailwind/src/lib/auth.js"],"sourcesContent":["// src/lib/auth.js\nimport { cookies } from \"next/headers\"\nimport { NextResponse } from \"next/server\"\n\nconst AUTH_COOKIE_NAME = \"app-auth\"\nconst DEFAULT_MAX_AGE = 60 * 60 * 24 * 7 // 7 days\n\nfunction encodeUserPayload(user) {\n  return Buffer.from(JSON.stringify(user), \"utf8\").toString(\"base64url\")\n}\n\nfunction decodeUserPayload(payload) {\n  try {\n    return JSON.parse(Buffer.from(payload, \"base64url\").toString(\"utf8\"))\n  } catch (error) {\n    console.warn(\"[auth] Failed to decode user payload\", error)\n    return null\n  }\n}\n\nexport async function getCurrentUser() {\n  const cookieStore = await cookies()\n  const sessionCookie = cookieStore.get(AUTH_COOKIE_NAME)\n  if (!sessionCookie?.value) {\n    return null\n  }\n\n  return decodeUserPayload(sessionCookie.value)\n}\n\nexport function createLoginResponse(user, { message = \"Authenticated\", status = 200, extra = {}, maxAge = DEFAULT_MAX_AGE } = {}) {\n  const response = NextResponse.json({ user, message, ...extra }, { status })\n  response.cookies.set({\n    name: AUTH_COOKIE_NAME,\n    value: encodeUserPayload(user),\n    httpOnly: true,\n    sameSite: \"lax\",\n    secure: process.env.NODE_ENV === \"production\",\n    path: \"/\",\n    maxAge,\n  })\n  return response\n}\n\nexport function createLogoutResponse({ message = \"Logged out\", status = 200 } = {}) {\n  const response = NextResponse.json({ ok: true, message }, { status })\n  response.cookies.set({\n    name: AUTH_COOKIE_NAME,\n    value: \"\",\n    httpOnly: true,\n    sameSite: \"lax\",\n    secure: process.env.NODE_ENV === \"production\",\n    path: \"/\",\n    expires: new Date(0),\n  })\n  return response\n}\n\nexport function buildUnauthenticatedResponse({ message = \"Not authenticated\", status = 401 } = {}) {\n  return NextResponse.json({ user: null, message }, { status })\n}\n\nexport { AUTH_COOKIE_NAME }\n"],"names":[],"mappings":"AAAA,kBAAkB;;;;;;;;;;;;;AAClB;AACA;;;AAEA,MAAM,mBAAmB;AACzB,MAAM,kBAAkB,KAAK,KAAK,KAAK,EAAE,SAAS;;AAElD,SAAS,kBAAkB,IAAI;IAC7B,OAAO,OAAO,IAAI,CAAC,KAAK,SAAS,CAAC,OAAO,QAAQ,QAAQ,CAAC;AAC5D;AAEA,SAAS,kBAAkB,OAAO;IAChC,IAAI;QACF,OAAO,KAAK,KAAK,CAAC,OAAO,IAAI,CAAC,SAAS,aAAa,QAAQ,CAAC;IAC/D,EAAE,OAAO,OAAO;QACd,QAAQ,IAAI,CAAC,wCAAwC;QACrD,OAAO;IACT;AACF;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,6WAAO;IACjC,MAAM,gBAAgB,YAAY,GAAG,CAAC;IACtC,IAAI,CAAC,eAAe,OAAO;QACzB,OAAO;IACT;IAEA,OAAO,kBAAkB,cAAc,KAAK;AAC9C;AAEO,SAAS,oBAAoB,IAAI,EAAE,EAAE,UAAU,eAAe,EAAE,SAAS,GAAG,EAAE,QAAQ,CAAC,CAAC,EAAE,SAAS,eAAe,EAAE,GAAG,CAAC,CAAC;IAC9H,MAAM,WAAW,iXAAY,CAAC,IAAI,CAAC;QAAE;QAAM;QAAS,GAAG,KAAK;IAAC,GAAG;QAAE;IAAO;IACzE,SAAS,OAAO,CAAC,GAAG,CAAC;QACnB,MAAM;QACN,OAAO,kBAAkB;QACzB,UAAU;QACV,UAAU;QACV,QAAQ,oDAAyB;QACjC,MAAM;QACN;IACF;IACA,OAAO;AACT;AAEO,SAAS,qBAAqB,EAAE,UAAU,YAAY,EAAE,SAAS,GAAG,EAAE,GAAG,CAAC,CAAC;IAChF,MAAM,WAAW,iXAAY,CAAC,IAAI,CAAC;QAAE,IAAI;QAAM;IAAQ,GAAG;QAAE;IAAO;IACnE,SAAS,OAAO,CAAC,GAAG,CAAC;QACnB,MAAM;QACN,OAAO;QACP,UAAU;QACV,UAAU;QACV,QAAQ,oDAAyB;QACjC,MAAM;QACN,SAAS,IAAI,KAAK;IACpB;IACA,OAAO;AACT;AAEO,SAAS,6BAA6B,EAAE,UAAU,mBAAmB,EAAE,SAAS,GAAG,EAAE,GAAG,CAAC,CAAC;IAC/F,OAAO,iXAAY,CAAC,IAAI,CAAC;QAAE,MAAM;QAAM;IAAQ,GAAG;QAAE;IAAO;AAC7D","debugId":null}},
    {"offset": {"line": 135, "column": 0}, "map": {"version":3,"sources":["file:///home/pjw75/tailwind/src/app/api/auth/sso-login/route.js"],"sourcesContent":["// src/app/api/auth/sso-login/route.js\nimport { createLoginResponse } from \"@/lib/auth\"\n\nexport async function POST(request) {\n  const payload = await request.json().catch(() => ({}))\n  const profile = payload?.profile ?? {}\n\n  const now = new Date().toISOString()\n  const user = {\n    id: profile.id ?? \"demo-openid-user\",\n    name: profile.name ?? profile.displayName ?? \"OpenID Demo User\",\n    email: profile.email ?? \"openid.demo@example.com\",\n    provider: \"openid\",\n    organization: profile.organization ?? \"Demo Organization\",\n    issuedAt: now,\n  }\n\n  const returnTo = payload?.returnTo && typeof payload.returnTo === \"string\"\n    ? payload.returnTo\n    : \"/\"\n\n  return createLoginResponse(user, {\n    message: \"Authenticated via OpenID Connect (demo)\",\n    extra: { returnTo },\n  })\n}\n"],"names":[],"mappings":"AAAA,sCAAsC;;;;;AACtC;;AAEO,eAAe,KAAK,OAAO;IAChC,MAAM,UAAU,MAAM,QAAQ,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;IACpD,MAAM,UAAU,SAAS,WAAW,CAAC;IAErC,MAAM,MAAM,IAAI,OAAO,WAAW;IAClC,MAAM,OAAO;QACX,IAAI,QAAQ,EAAE,IAAI;QAClB,MAAM,QAAQ,IAAI,IAAI,QAAQ,WAAW,IAAI;QAC7C,OAAO,QAAQ,KAAK,IAAI;QACxB,UAAU;QACV,cAAc,QAAQ,YAAY,IAAI;QACtC,UAAU;IACZ;IAEA,MAAM,WAAW,SAAS,YAAY,OAAO,QAAQ,QAAQ,KAAK,WAC9D,QAAQ,QAAQ,GAChB;IAEJ,OAAO,IAAA,uJAAmB,EAAC,MAAM;QAC/B,SAAS;QACT,OAAO;YAAE;QAAS;IACpB;AACF","debugId":null}}]
}