# ============================================================================
# Shared Django configuration
# 이 파일은 dev/prod 공통으로 유지하고, 세부 차이는 api.dev.env / api.prod.env
# 에서 override 합니다.
# ============================================================================

# --- Core metadata ----------------------------------------------------------
# 기본 타임존 (필요 시 Asia/Seoul 등으로 변경)
DJANGO_TIME_ZONE=UTC

# --- Database connection ----------------------------------------------------
# 데이터베이스 백엔드 (PostgreSQL 고정)
DJANGO_DB_ENGINE=django.db.backends.postgresql
# DB 이름 (서비스용 DB를 사전에 생성)
DJANGO_DB_NAME=appdb
# 접속 계정 정보
DJANGO_DB_USER=airflow
DJANGO_DB_PASSWORD=airflow
# Compose 외부(shared-net)의 postgres 컨테이너 이름 혹은 호스트네임
# production에서는 실 DB 호스트명으로 교체하세요.
DJANGO_DB_HOST=airflow-postgres
# DB 포트
DJANGO_DB_PORT=5432
# 커넥션 풀 타임아웃(초). 장기 접속 유지 시 숫자를 높입니다.
DJANGO_DB_CONN_MAX_AGE=60

# --- Auth redirect URLs -----------------------------------------------------
# 로그인/로그아웃 후 기본 리다이렉트 경로
DJANGO_LOGIN_REDIRECT_URL=/
DJANGO_LOGOUT_REDIRECT_URL=/

# --- Reverse proxy awareness ------------------------------------------------
# Nginx 뒤에서 동작 시 필수 헤더 설정들
USE_X_FORWARDED_HOST=1
DJANGO_USE_PROXY_SSL_HEADER=1
SECURE_REFERRER_POLICY=same-origin

# --- Public API exposure ----------------------------------------------------
# 리버스 프록시가 /api 등 접두사로 API를 노출할 경우 설정.
# 예) /api  또는  https://api.example.com
# 기본값은 빈 값(직접 서빙)이며, dev/prod override 파일에서 덮어씁니다.
PUBLIC_API_BASE_URL=

# --- Optional OIDC provider -------------------------------------------------
# 외부 IdP 연동 시 값 입력, 비워두면 dev 로그인 루트가 활성화됩니다.
OIDC_RP_CLIENT_ID=
OIDC_RP_CLIENT_SECRET=
OIDC_RP_SIGN_ALGO=HS256
OIDC_OP_AUTHORIZATION_ENDPOINT=
OIDC_OP_TOKEN_ENDPOINT=
OIDC_OP_USER_ENDPOINT=
OIDC_OP_JWKS_ENDPOINT=

# --- Dummy login defaults ---------------------------------------------------
# 데모 계정 (dev 로그인 fallback용)
AUTH_DUMMY_EMAIL=demo@example.com
AUTH_DUMMY_NAME=Demo User

# --- Gunicorn runtime defaults ---------------------------------------------
# production 빌드 시 entrypoint에서 참조하는 기본 스레드/워커 수
GUNICORN_WORKERS=3
GUNICORN_THREADS=2
